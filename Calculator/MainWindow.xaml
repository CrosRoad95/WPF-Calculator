<Window x:Class="Kalkulator.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        mc:Ignorable="d"
        Title="Kalkulator"
        Height="566"
        Width="322"
        MinHeight="566"
        MinWidth="322"
        Background="#202020"
        WindowStyle="None"
        WindowStartupLocation="CenterScreen"
        ResizeMode="CanResizeWithGrip"
        AllowsTransparency="True">

    <DockPanel MouseDown="DockPanel_MouseDown">
        <Border Background="#202020" Height="32" DockPanel.Dock="Top">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <!-- App Icon -->
                <Image Source="appicon.png" Width="24" Height="24" Margin="5" VerticalAlignment="Center"/>

                <!-- Window Title -->
                <TextBlock Grid.Column="1" Text="Kalkulator" VerticalAlignment="Center"
                   FontFamily="Segoe UI Variable"
                   FontWeight="Regular"
                   FontSize="12"
                   Foreground="White"/>

                <!-- Window Buttons -->
                <StackPanel Grid.Column="2" Orientation="Horizontal">
                    <Button FontSize="10" Content="—" Width="46" Background="Transparent" Foreground="#787878" BorderBrush="Transparent" Click="Minimize_Click"/>
                    <Button FontSize="14" Content="☐" Width="46" Background="Transparent" Foreground="#787878" BorderBrush="Transparent" Click="Maximize_Click"/>
                    <Button FontSize="14" Content="✕" Width="46" Background="Transparent" Foreground="#787878" BorderBrush="Transparent" Click="Close_Click"/>
                </StackPanel>
            </Grid>
        </Border>
        <StackPanel Background="Transparent" DockPanel.Dock="Top" Height="36" HorizontalAlignment="Stretch" Orientation="Horizontal">
            <DockPanel LastChildFill="True">
                <Button FontSize="24" Content="≡" Width="40" DockPanel.Dock="Left"
            VerticalAlignment="Stretch" Background="Transparent"
            Foreground="#787878" BorderBrush="Transparent"
            Click="ExpandCollapseMenu_Click"/>

                <TextBlock Text="{Binding Selected.Name}" d:Text="Selected calculator name"
               FontFamily="Segoe UI Variable"
               FontWeight="Regular"
               FontSize="16"
               Foreground="White" VerticalAlignment="Center"
               HorizontalAlignment="Center"/>
                <Button FontSize="24" Content="↩" Width="40" DockPanel.Dock="Right"
            VerticalAlignment="Stretch" Background="Transparent"
            Foreground="#787878" BorderBrush="Transparent"
            Click="OpenHistory_Click"/>

            </DockPanel>
            
        </StackPanel>
        <Grid>
            <StackPanel Background="#FF292422"
            DockPanel.Dock="Left"
            Width="256"
            HorizontalAlignment="Left"
            Orientation="Vertical"
            Visibility="Hidden"
                    Panel.ZIndex="100"
            x:Name="Menu">

                <ItemsControl ItemsSource="{Binding CalculatorsByType}">
                    <ItemsControl.ItemTemplate>
                        <DataTemplate>
                            <!-- Wrap both Grids in a StackPanel -->
                            <StackPanel Orientation="Vertical">
                                <!-- First Grid -->
                                <Grid Height="36">
                                    <TextBlock Text="{Binding Key}"
                                   FontFamily="Segoe UI Variable"
                                   FontWeight="Regular"
                                   FontSize="12"
                                   Padding="10,0,0,0"
                                   Foreground="White"
                                   VerticalAlignment="Center"
                                   HorizontalAlignment="Left"/>
                                </Grid>

                                <!-- Second Grid -->
                                <ItemsControl ItemsSource="{Binding Value}">
                                    <ItemsControl.ItemTemplate>

                                        <DataTemplate>
                                            <Grid MouseLeftButtonDown="MenuItem_Click">
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="48"/>
                                                    <ColumnDefinition Width="*"/>
                                                </Grid.ColumnDefinitions>
                                                <Grid.RowDefinitions>
                                                    <RowDefinition Height="36" />
                                                    <RowDefinition Height="Auto" />
                                                </Grid.RowDefinitions>

                                                <TextBlock Text="{Binding Icon}"
                                   FontSize="32"
                                   VerticalAlignment="Center"
                                   HorizontalAlignment="Center"
                                   Foreground="White"
                                   Height="36"
                                   RenderTransformOrigin="0.5,0.5">
                                                    <TextBlock.RenderTransform>
                                                        <TransformGroup>
                                                            <ScaleTransform/>
                                                            <SkewTransform/>
                                                            <RotateTransform/>
                                                            <TranslateTransform Y="-7"/>
                                                        </TransformGroup>
                                                    </TextBlock.RenderTransform>
                                                </TextBlock>

                                                <TextBlock Grid.Column="1" Text="{Binding Name}"
                                   FontFamily="Segoe UI Variable"
                                   FontWeight="Regular"
                                   FontSize="14"
                                   Foreground="White"
                                   VerticalAlignment="Center"/>
                                            </Grid>
                                        </DataTemplate>
                                    </ItemsControl.ItemTemplate>
                                </ItemsControl>
                            </StackPanel>
                        </DataTemplate>
                    </ItemsControl.ItemTemplate>
                </ItemsControl>
            </StackPanel>


            <StackPanel Background="#FF292422"
            DockPanel.Dock="Right"
            Width="256"
            HorizontalAlignment="Right"
            Orientation="Vertical"
            Visibility="Hidden"
            Panel.ZIndex="100"
            x:Name="History">
                <Button Content="🗑" Width="36" HorizontalAlignment="Right" Click="Clear_Click"/>
                <ListBox ItemsSource="{Binding SavedEntries}"
         Background="#FF292422"
         BorderThickness="0"
         x:Name="HistoryListBox"
                         HorizontalAlignment="Stretch"
                          HorizontalContentAlignment="Right"
         MouseLeftButtonUp="SavedEntryRestore_Click">
                    <ListBox.ItemTemplate>
                        <DataTemplate>
                            <Grid Margin="0,0,16,0"
                                  MouseLeftButtonDown="SavedEntryRestore_Click"
                                  >
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="36"/>
                                    <RowDefinition Height="36"/>
                                </Grid.RowDefinitions>

                                <TextBlock Grid.Row="0" Text="{Binding Item1}"
                           FontFamily="Segoe UI Variable"
                           FontWeight="Regular"
                           FontSize="16"
                           Padding="10,0,0,0"
                           Foreground="#999999"
                           VerticalAlignment="Center"
                           HorizontalAlignment="Right"
                           IsHitTestVisible="False"/>

                                <TextBlock Grid.Row="1" Text="{Binding Item2}"
                           FontFamily="Segoe UI Variable"
                           FontWeight="Regular"
                           FontSize="20"
                           Padding="10,0,0,0"
                           Foreground="White"
                           VerticalAlignment="Center"
                           HorizontalAlignment="Right"
                           IsHitTestVisible="False"/>
                            </Grid>
                        </DataTemplate>
                    </ListBox.ItemTemplate>
                </ListBox>

            </StackPanel>

            <Grid x:Name="Content" />
        </Grid>
    </DockPanel>
</Window>
